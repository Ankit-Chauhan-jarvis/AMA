[
    {
        "speaker": "SPEAKER_03",
        "start": 0.031,
        "end": 11.724,
        "text": "Hey, everyone. This is the environments design pairing session on October 26. And Anna has the first topic. So I'll pass it over to her to introduce."
    },
    {
        "speaker": "SPEAKER_02",
        "start": 13.366,
        "end": 83.65,
        "text": "Thank you. I wanted to discuss a few things related to the Vojti API for the Kubernetes resources. So I was playing with it yesterday. And I had a couple of questions here. So When we do the watch request, the API expects the data may appear even if it's not there yet. So for example, if we fetch the bots in the selected namespace, they might not be present there, but we will still wait for five minutes as the five minutes is the Kubernetes limit. for them to appear. And currently, we are showing the loading animation for the whole five minutes. And after having the timeout, we render the zero bot state, which I guess it's not the best way to handle it. So I was thinking probably we could start with showing zero. But then we'll probably want to indicate somehow that we are still loading."
    },
    {
        "speaker": "SPEAKER_03",
        "start": 83.798,
        "end": 101.576,
        "text": "So it's like at the start we want to, like it will load for five minutes and then show zero. But in those five minutes, it's kind of in the state that no one, the user won't know kind of what's happening. That's true. That's not like the best case. And it's."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 103.178,
        "end": 103.798,
        "text": "Sorry, sorry."
    },
    {
        "speaker": "SPEAKER_03",
        "start": 104.679,
        "end": 113.468,
        "text": "No worries. And it'll take the full five minutes to time out. There's nothing we can kind of do before that, right? Yeah."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 115.557,
        "end": 132.455,
        "text": "What I was thinking that you proposed a bit alternative approach for the Flux resource, which is that firstly query the resource and after we sign up for the watch. Would this be an option for the pods as well?"
    },
    {
        "speaker": "SPEAKER_02",
        "start": 134.257,
        "end": 137.541,
        "text": "Yeah, we can do that."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 137.561,
        "end": 189.388,
        "text": "And then you, there you wrote one more thing, which was that Yeah, that it's easier to implement. I totally understand if you don't do this, but go with a single one and there is a less fetch requests, but, um, but here we would have. Two requests per resource, like for the pods and for flux. First, I don't consider it too many. And the other is that they would be sequential so that we run the first, it returns, then we do the next. It doesn't return because it's a watch. But so to me, it doesn't feel to be a big issue that we are doing these sequential requests. And I would like to know if I'm correct or wrong with this."
    },
    {
        "speaker": "SPEAKER_02",
        "start": 192.676,
        "end": 214.217,
        "text": "I think it should be fine if you're querying only for pods and Flux resources. So for Flux, we also have a logic of searching for customization and if it's not there, searching for the hammer release. So it would be probably three requests."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 215.658,
        "end": 240.989,
        "text": "So yeah, I think that was just a bad idea from me on the first part. place to ask for that logic. I wrote it already somewhere in a comment. I think we can just remove from that idea. We can remove that logic altogether and say that like, if you selected something, we go with that. Otherwise you are on your own. So we don't do anything like that."
    },
    {
        "speaker": "SPEAKER_02",
        "start": 241.009,
        "end": 245.053,
        "text": "That makes sense. It would help."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 245.073,
        "end": 249.398,
        "text": "Yeah, let's do that. I will take a note of it here somewhere."
    },
    {
        "speaker": "SPEAKER_02",
        "start": 250.62,
        "end": 250.78,
        "text": "Okay."
    },
    {
        "speaker": "SPEAKER_03",
        "start": 262.083,
        "end": 264.946,
        "text": "Does that answer the first question as well?"
    },
    {
        "speaker": "SPEAKER_02",
        "start": 268.028,
        "end": 287.266,
        "text": "Yeah, I think so. So if we decide to go with a similar approach for the pods as well, we're just going to implement this first call to just check if anything is there. And if it is, we can watch for the changes."
    },
    {
        "speaker": "SPEAKER_03",
        "start": 288.267,
        "end": 297.462,
        "text": "Because then we'd show right away there's like zero pods and then they'd Yeah, I think that would."
    },
    {
        "speaker": "SPEAKER_02",
        "start": 298.504,
        "end": 298.744,
        "text": "Cool."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 298.764,
        "end": 300.146,
        "text": "You have a few more questions there."
    },
    {
        "speaker": "SPEAKER_02",
        "start": 301.407,
        "end": 341.314,
        "text": "Yeah, I was also thinking about refreshing the stream. So currently, we have it for five minutes if no error occurs. And I'm not sure if you want to resubscribe right away, for example, on the environment the page, you could open like 10 environments at a time. And it's already like five requests, I guess, from each one. So I was thinking about having some kind of an icon for the user to press if they wanted to load fresh data there."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 345.968,
        "end": 346.709,
        "text": "Victor?"
    },
    {
        "speaker": "SPEAKER_00",
        "start": 346.729,
        "end": 353.675,
        "text": "For that one, are we concerned about the performance on the client side or hitting the server with so many requests?"
    },
    {
        "speaker": "SPEAKER_02",
        "start": 357.678,
        "end": 358.579,
        "text": "I guess kind of both."
    },
    {
        "speaker": "SPEAKER_02",
        "start": 362.022,
        "end": 374.153,
        "text": "It's less of a concern on the Kubernetes dashboard pages because it's mainly one resource per page. But on the environment page, it could be a bunch of requests."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 392.223,
        "end": 413.426,
        "text": "Yeah, so I really wanted to ask this even before, but like, do we run these requests in a worker or on the main UI thread? Like, because if you are concerned about the client side, then putting it in a worker might solve it."
    },
    {
        "speaker": "SPEAKER_02",
        "start": 415.548,
        "end": 421.555,
        "text": "Yeah, we do it on the main UI thread right now. You might want to reconsider it."
    },
    {
        "speaker": "SPEAKER_00",
        "start": 425.973,
        "end": 436.748,
        "text": "We trigger some of these requests based off of the visibility of the tab as well. And then we use that a lot in the old polling style stuff."
    },
    {
        "speaker": "SPEAKER_02",
        "start": 436.768,
        "end": 441.895,
        "text": "Yeah, that's true."
    },
    {
        "speaker": "SPEAKER_00",
        "start": 442.056,
        "end": 451.489,
        "text": "And I think the browser has a lot of stuff built in surrounding delaying requests if a tab is invisible as well, especially on lower power devices, right?"
    },
    {
        "speaker": "SPEAKER_01",
        "start": 453.452,
        "end": 454.393,
        "text": "Yeah, I think so."
    },
    {
        "speaker": "SPEAKER_03",
        "start": 463.672,
        "end": 481.637,
        "text": "Do we show anywhere where things have been last updated? So when you mentioned adding a refresh icon to the UI, do they know to hit that after five minutes? Are we showing that anywhere? No, we currently didn't show it anywhere."
    },
    {
        "speaker": "SPEAKER_02",
        "start": 481.677,
        "end": 492.092,
        "text": "Because I feel like it's just the data being updated in support section. And I'm also working on updating it in the FluxSync status section."
    },
    {
        "speaker": "SPEAKER_03",
        "start": 493.979,
        "end": 500.287,
        "text": "So I think an important aspect of that might be to also show last updated and then give them the option to, so."
    },
    {
        "speaker": "SPEAKER_02",
        "start": 502.57,
        "end": 504.111,
        "text": "Yeah, that makes sense."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 511.322,
        "end": 646.971,
        "text": "Okay, let me take a step back and tell you a few thoughts I have around this. And Emily, I would love to hear your thoughts primarily because my impression is that we might introduce a confusing user interface and at the same time complexity on the code side, which is like, why? I would say why I'm worried about the confusing user experience, which is that we discussed that we would make the watch API for the pods and for the flux resource reconciliation status only. but that page shows the deployment, stateful sets in different tabbed services that we are not watching, we are just requesting once. And then basically we add this refresh button, like would that refresh the whole page or the data or would it just resubscribe for the watch API? If it refreshes all the data, that makes sense to me, but then we could even add it today without the watch API. And we can actually add the watch API even later saying that with an icon showing that these data are continuously watched while the other data are not. And then once the watch is done, we remove the watch API. those watch icons and there is the refresh button again to subscribe, for example. But what I'm worried about is that it might be a bit confusing and that's why I think your last question that we need an indicator for the pods and for the Flux Sync status that it's being watched continuously. At the same time, the refresh button should be about the whole NAT page because it's just a... an accordion, but the whole section that we refresh all the data, I think. And this was my rant on these topics. I don't know, what do you think about this?"
    },
    {
        "speaker": "SPEAKER_02",
        "start": 648.47,
        "end": 676.131,
        "text": "That makes sense. I was also thinking of using WatchAPI for pods and for flags just as a first iteration so that we can edit for every resource type. And if we keep the logic of requesting it once so we can save us a lot of WatchAPI calls for the resources that are not needed, then it would be more obvious from the UI that we are watching for the whole and you can refresh the whole view."
    },
    {
        "speaker": "SPEAKER_02",
        "start": 679.891,
        "end": 680.131,
        "text": "Good."
    },
    {
        "speaker": "SPEAKER_03",
        "start": 681.173,
        "end": 703.975,
        "text": "Yeah. And Victor, I agree with your concern there that the placement of a refresh, we have to do very well, or it has to refresh the entire section. So wherever this is placed, it has to be obvious that you click it and what it is refreshing. So that's something that I'll probably have to figure out, but agreed that is a concern."
    },
    {
        "speaker": "SPEAKER_03",
        "start": 707.178,
        "end": 718.376,
        "text": "And I think if it refreshed everything in that container, that would be the ideal case. Because I think having a refresh icon that only refreshes some of the data is not a good experience."
    },
    {
        "speaker": "SPEAKER_02",
        "start": 720.881,
        "end": 721.201,
        "text": "I agree."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 726.83,
        "end": 757.215,
        "text": "OK, then just to summarize the whole discussion, and see whether we are on the same page. So one thing is to make two sequential calls when we watch something, one to query and then start watching. We will start watching only if there was a response or we start watching anyway and we just show a zero number, the letter. We would start watching anyway and we just show that there are zero points right now, right?"
    },
    {
        "speaker": "SPEAKER_02",
        "start": 759.305,
        "end": 771.994,
        "text": "If we expect this to change, we could show, we could watch anyway, but for flux resources, probably by name. So if it's not there, it probably won't be there."
    },
    {
        "speaker": "UNKNOWN",
        "start": 773.197,
        "end": 773.297,
        "text": "Yeah."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 797.307,
        "end": 816.409,
        "text": "Correct. Yeah. Okay. And then for the refresh, we do not auto-reconnect to the watch API, but we will have a refresh button that refreshes the whole container and icons to show that pods and flags are being watched."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 823.176,
        "end": 826.42,
        "text": "Is that, was that a proper summary?"
    },
    {
        "speaker": "SPEAKER_02",
        "start": 828.053,
        "end": 829.034,
        "text": "I think so."
    },
    {
        "speaker": "SPEAKER_00",
        "start": 829.054,
        "end": 843.088,
        "text": "Yes. I think we might want to watch still if there are zero pods, uh, because you could see a person showing up to a page watching, like expecting to watch all their pods roll out."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 846.431,
        "end": 864.407,
        "text": "Yeah, definitely. So yeah, that, I think, um, that's what I wrote up as well at the top that four flags we don't watch if there is no No response, basically, or no flax resource, but for the pods, we do start the watch."
    },
    {
        "speaker": "SPEAKER_00",
        "start": 864.727,
        "end": 868.631,
        "text": "Yeah. Yeah."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 870.714,
        "end": 871.714,
        "text": "Cool."
    },
    {
        "speaker": "SPEAKER_03",
        "start": 873.878,
        "end": 883.069,
        "text": "So next steps for me, Anna, do you need my help with any of this? And if so, what should I kind of do after this meeting to move it forward?"
    },
    {
        "speaker": "SPEAKER_02",
        "start": 884.146,
        "end": 915.338,
        "text": "Yeah, I really need your help on placing this icon and maybe showing different states of the icon. So we probably don't want the user to refresh it before the timeout, but it could be also confusing if we do refresh the watch API together with just single calls. Is there any- It would be much easier when we do the watch API for the whole section."
    },
    {
        "speaker": "SPEAKER_03",
        "start": 916.901,
        "end": 924.472,
        "text": "Cool. Is there an issue open about this too, or should we open something? I'll create an issue after the meeting. Cool. Sounds good."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 932.224,
        "end": 933.967,
        "text": "Thank you, Anna, for the questions."
    },
    {
        "speaker": "SPEAKER_03",
        "start": 935.65,
        "end": 941.117,
        "text": "Yeah, thank you. It's really helpful. Yeah, thanks for bringing a topic to the design pair."
    },
    {
        "speaker": "SPEAKER_03",
        "start": 945.374,
        "end": 949.168,
        "text": "Does anyone have any other comments or questions on this?"
    },
    {
        "speaker": "SPEAKER_03",
        "start": 961.636,
        "end": 973.653,
        "text": "If not, I know we're kind of getting to the, this is a shorter design pair session today because Victor and I have a product direction showcase next. So if there's no other questions, we can end it slightly earlier."
    },
    {
        "speaker": "SPEAKER_03",
        "start": 978.059,
        "end": 979.922,
        "text": "Cool. Well, I hope everyone has a great rest of your day."
    },
    {
        "speaker": "SPEAKER_01",
        "start": 982.245,
        "end": 983.245,
        "text": "Bye."
    },
    {
        "speaker": "SPEAKER_03",
        "start": 983.527,
        "end": 984.268,
        "text": "Thank you. Bye."
    }
]